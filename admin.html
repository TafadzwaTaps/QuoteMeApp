<section id="adminPanel">
    <h2>Admin Panel</h2>

    <div id="loginSection">
        <input type="text" id="adminUser" placeholder="Username">
        <input type="password" id="adminPass" placeholder="Password">
        <button onclick="loginAdmin()">Login</button>
    </div>

    <div id="contentManagement" style="display:none;">
        <h3>Quotes Management</h3>
        <div id="quoteList"></div>
        <input type="text" id="newQuoteText" placeholder="New Quote">
        <button onclick="addQuote()">Add Quote</button>
    </div>
</section>

<script>
let token = '';

async function loginAdmin() {
    const username = document.getElementById('adminUser').value;
    const password = document.getElementById('adminPass').value;

    const res = await fetch('http://localhost:8000/admin/login', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({username, password})
    });

    const data = await res.json();
    if(data.token) {
        token = data.token;
        document.getElementById('loginSection').style.display='none';
        document.getElementById('contentManagement').style.display='block';
        loadQuotes();
    } else {
        alert('Login failed');
    }
}

async function loadQuotes() {
    const res = await fetch('http://localhost:8000/quotes');
    const quotes = await res.json();
    const quoteList = document.getElementById('quoteList');
    quoteList.innerHTML = '';
    quotes.forEach(q => {
        const div = document.createElement('div');
        div.innerHTML = `${q.text} 
            <button onclick="deleteQuote(${q.id})">Delete</button>`;
        quoteList.appendChild(div);
    });
}

async function addQuote() {
    const text = document.getElementById('newQuoteText').value;
    await fetch('http://localhost:8000/quotes', {
        method:'POST',
        headers:{'Content-Type':'application/json','token': token},
        body: JSON.stringify({text})
    });
    document.getElementById('newQuoteText').value='';
    loadQuotes();
}

async function deleteQuote(id) {
    await fetch(`http://localhost:8000/quotes/${id}`, {
        method:'DELETE',
        headers:{'token': token}
    });
    loadQuotes();
}
</script>
